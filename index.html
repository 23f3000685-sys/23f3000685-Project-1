<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Captcha Solver</title>
  <link rel="stylesheet" href="style.css">
  <script src="script.js" defer></script>
</head>
<body>
  <div class="container">
    <h1>Captcha Solver</h1>
    <img id="captcha" src="" alt="Captcha Image">
    <p id="solution">Solving...</p>
  </div>
</body>
<head>
  <meta charset="UTF-8">
  <title>Evaluator JSON Preview</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>Evaluator JSON Preview</h1>
    <pre id="jsonOutput">Loading...</pre>
  </div>

  <script>
    async function loadJSONPreview() {
      // Extract repo info from URL
      const hostParts = window.location.host.split('.');
      const username = hostParts[0];
      const pathParts = window.location.pathname.split('/');
      const repoPath = pathParts[1] || "captcha-solver-23f3000685";
      const pagesURL = `https://${username}.github.io/${repoPath}/`;

      // Dynamic commit SHA (pseudo)
      const commitSHA = Date.now().toString(16).slice(-7);

      // Dynamic nonce
      const defaultNonce = 'nonce-' + Math.random().toString(36).slice(2, 10);

      // Fetch round from round.json if exists
      let round = 1;
      try {
        const res = await fetch('round.json');
        if (res.ok) {
          const roundData = await res.json();
          round = roundData.round || 1;
        }
      } catch (e) {
        console.warn("round.json not found, defaulting to round 1");
      }

      // Query params override
      const params = new URLSearchParams(window.location.search);

      const payload = {
        email: params.get("email") || "23f3000685@ds.study.iitm.ac.in",
        task: params.get("task") || repoPath,
        round: parseInt(params.get("round")) || round,
        nonce: params.get("nonce") || defaultNonce,
        repo_url: params.get("repo_url") || `https://github.com/${username}/${repoPath}`,
        commit_sha: params.get("commit_sha") || commitSHA,
        pages_url: params.get("pages_url") || pagesURL
      };

      document.getElementById("jsonOutput").textContent = JSON.stringify(payload, null, 2);
    }

    loadJSONPreview();
  </script>
</body>
</html>
